`EpiCompare`: QC and Benchmarking of Epigenetic Datasets
================
Sera Choi
<h5>
<i>Updated</i>: Feb-19-2022
</h5>

<!-- badges: start -->

[![](https://img.shields.io/badge/devel%20version-0.99.0-black.svg)](https://github.com/neurogenomics/EpiCompare)
[![R build
status](https://github.com/neurogenomics/EpiCompare/workflows/R-CMD-check-bioc/badge.svg)](https://github.com/neurogenomics/EpiCompare/actions)
[![R build
status](https://github.com/neurogenomics/EpiCompare/workflows/DockerHub/badge.svg)](https://github.com/neurogenomics/EpiCompare/actions)
[![](https://codecov.io/gh/neurogenomics/EpiCompare/branch/master/graph/badge.svg)](https://codecov.io/gh/neurogenomics/EpiCompare)
[![License:
GPL-3](https://img.shields.io/badge/license-GPL--3-blue.svg)](https://cran.r-project.org/web/licenses/GPL-3)
<!-- badges: end -->

# Introduction

`EpiCompare` is an R package for comparing different epigenetic datasets
for quality control and benchmarking purposes. The function outputs a
report in HTML format consisting of three sections:

1.  General Metrics: Metrics on peaks (blacklisted peaks and peak
    widths) and fragments (duplication rate) of input epigenetic
    datasets
2.  Peak Overlap: Percentage and statistical significance of overlapping
    and non-overlapping peaks
3.  Functional Annotation: Functional annotation (ChromHMM, ChIPseeker
    and enrichment analysis) of peaks

N.B. All functional analyses performed by EpiCompare uses annotations
for human genome hg19. N.B. Peaks in blacklisted regions and
non-standard chromosomes are removed from peak files before any analysis

# Installation

To install `EpiCompare` use:

``` r
if(!require("remotes")) install.packages("remotes")
remotes::install_github("neurogenomics/EpiCompare")
```

# Usage

Load package and example datasets.

``` r
library(EpiCompare)
data("encode_H3K27ac") # example peakfile
data("CnT_H3K27ac") # example peakfile
data("CnR_H3K27ac") # example peakfile
data("hg19_blacklist") # example blacklist 
```

Run EpiCompare:

``` r
peaklist <- list(encode_H3K27ac, CnT_H3K27ac, CnR_H3K27ac) 
namelist <- c("encode", "CnT", "CnR")
EpiCompare(peakfiles = peaklist,
           names = namelist,
           blacklist = hg19_blacklist,
           reference = encode_H3K27ac,
           stat_plot = TRUE,
           chrmHMM_plot = TRUE,
           chipseeker_plot = TRUE,
           enrichment_plot = TRUE,
           save_output = TRUE,
           output_dir = "/path/to/output")
```

#### Mandatory Inputs

These input parameters must be provided:

-   `peakfiles` : Peakfiles you want to analyse. The files must be in
    GRanges object. To convert BED files into GRanges, use
    `ChIPseeker::readPeakFile("/path/to/peak/file", as = "GRanges")`. If
    there are more than one peakfiles, the files must be listed using
    `list()` and named using for example,
    `names(peaklist) <- c("sample1","sample2)`
-   `blacklist` : Peakfile as GRanges object specifying genomic regions
    that have anomalous and/or unstructured signals independent of the
    cell-line or experiment. For human genome hg19, use
    `data(hg19_blacklist)` stored in the package.

#### Optional Plots

By default, these plots will not be included in the report unless set
`TRUE`.

-   `stat_plot` : included only if a `reference` dataset is provided.
    The plot shows statistical significance (p/q-values) of sample peaks
    that are overlapping/non-overlapping with the `reference` dataset.
-   `chrmHMM_plot` : ChromHMM annotation of peaks. If a `reference`
    dataset is provided, ChromHMM annotation of overlapping and
    non-overlapping peaks with the `reference` is also included in the
    report.
-   `chipseeker_plot` : ChIPseeker annotation of peaks.
-   `enrichment_plot` : KEGG pathway and GO enrichment analysis of
    peaks.

#### Optional Inputs

-   `picard_files` : A list of summary metrics output from Picard. If
    provided, metrics on fragments (e.g.Â mapped fragments and
    duplication rate) will be included in the report. Files must be in
    data.frame format and listed using `list()` and named using
    `names()`. To import Picard duplication metrics (.txt file) into R
    as data frame, use
    `picard <- read.table("/path/to/picard/output", header = TRUE, fill = TRUE)`.
-   `reference` : Reference peak file used in `stat_plot` and
    `chrmHMM_plot`. File must be in GRanges object and named using
    `names()`.

#### Outputs

`EpiCompare` outputs the following:

-   HTML report: A summary of all analyses saved in specified
    `output_dir`
-   EpiCompare_file: if `save_output=TRUE`, all plots generated by
    EpiCompare will be saved in EpiCompare_file directory also in
    specified `output_dir`

# Documentation

[EpiCompare Website](https://neurogenomics.github.io/EpiCompare)

# Example

\[how to run and link to an example html \]

# Session Info

<details>

``` r
utils::sessionInfo()
```

    ## R version 4.0.2 (2020-06-22)
    ## Platform: x86_64-apple-darwin17.0 (64-bit)
    ## Running under: macOS  10.16
    ## 
    ## Matrix products: default
    ## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
    ## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
    ## 
    ## locale:
    ## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
    ## 
    ## attached base packages:
    ## [1] stats     graphics  grDevices utils     datasets  methods   base     
    ## 
    ## loaded via a namespace (and not attached):
    ##  [1] tidyselect_1.1.1    xfun_0.29           purrr_0.3.4        
    ##  [4] colorspace_2.0-2    vctrs_0.3.8         generics_0.1.1     
    ##  [7] htmltools_0.5.2     usethis_2.1.5       yaml_2.2.1         
    ## [10] utf8_1.2.2          rlang_0.4.12        gert_1.4.3         
    ## [13] pillar_1.6.4        glue_1.6.0          DBI_1.1.2          
    ## [16] RColorBrewer_1.1-2  rvcheck_0.2.1       lifecycle_1.0.1    
    ## [19] stringr_1.4.0       dlstats_0.1.4       munsell_0.5.0      
    ## [22] gtable_0.3.0        evaluate_0.14       knitr_1.37         
    ## [25] fastmap_1.1.0       curl_4.3.2          sys_3.4            
    ## [28] fansi_0.5.0         openssl_1.4.6       scales_1.1.1       
    ## [31] BiocManager_1.30.16 desc_1.4.0          jsonlite_1.7.2     
    ## [34] fs_1.5.2            credentials_1.3.2   ggplot2_3.3.5      
    ## [37] askpass_1.1         digest_0.6.29       stringi_1.7.6      
    ## [40] gh_1.3.0            dplyr_1.0.7         grid_4.0.2         
    ## [43] rprojroot_2.0.2     cli_3.1.0           tools_4.0.2        
    ## [46] yulab.utils_0.0.4   magrittr_2.0.1      tibble_3.1.6       
    ## [49] crayon_1.4.2        pkgconfig_2.0.3     ellipsis_0.3.2     
    ## [52] assertthat_0.2.1    rmarkdown_2.11.3    httr_1.4.2         
    ## [55] rstudioapi_0.13     gitcreds_0.1.1      badger_0.1.0       
    ## [58] R6_2.5.1            compiler_4.0.2

</details>

## Contact

### [Neurogenomics Lab](https://www.neurogenomics.co.uk/)

UK Dementia Research Institute  
Department of Brain Sciences  
Faculty of Medicine  
Imperial College London  
[GitHub](https://github.com/neurogenomics)  
[DockerHub](https://hub.docker.com/orgs/neurogenomicslab)

<br>
